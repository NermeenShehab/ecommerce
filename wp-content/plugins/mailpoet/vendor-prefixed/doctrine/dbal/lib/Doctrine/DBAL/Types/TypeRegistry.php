<?php
 declare (strict_types=1); namespace MailPoetVendor\Doctrine\DBAL\Types; if (!defined('ABSPATH')) exit; use MailPoetVendor\Doctrine\DBAL\Exception; use function array_search; use function in_array; final class TypeRegistry { private $instances; public function __construct(array $instances = []) { $this->instances = $instances; } public function get(string $name) : \MailPoetVendor\Doctrine\DBAL\Types\Type { if (!isset($this->instances[$name])) { throw \MailPoetVendor\Doctrine\DBAL\Exception::unknownColumnType($name); } return $this->instances[$name]; } public function lookupName(\MailPoetVendor\Doctrine\DBAL\Types\Type $type) : string { $name = $this->findTypeName($type); if ($name === null) { throw \MailPoetVendor\Doctrine\DBAL\Exception::typeNotRegistered($type); } return $name; } public function has(string $name) : bool { return isset($this->instances[$name]); } public function register(string $name, \MailPoetVendor\Doctrine\DBAL\Types\Type $type) : void { if (isset($this->instances[$name])) { throw \MailPoetVendor\Doctrine\DBAL\Exception::typeExists($name); } if ($this->findTypeName($type) !== null) { throw \MailPoetVendor\Doctrine\DBAL\Exception::typeAlreadyRegistered($type); } $this->instances[$name] = $type; } public function override(string $name, \MailPoetVendor\Doctrine\DBAL\Types\Type $type) : void { if (!isset($this->instances[$name])) { throw \MailPoetVendor\Doctrine\DBAL\Exception::typeNotFound($name); } if (!\in_array($this->findTypeName($type), [$name, null], \true)) { throw \MailPoetVendor\Doctrine\DBAL\Exception::typeAlreadyRegistered($type); } $this->instances[$name] = $type; } public function getMap() : array { return $this->instances; } private function findTypeName(\MailPoetVendor\Doctrine\DBAL\Types\Type $type) : ?string { $name = \array_search($type, $this->instances, \true); if ($name === \false) { return null; } return $name; } } 